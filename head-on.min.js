(function(l){var h={groups:{},images:{},fps:50,imagesLoaded:!1,gameTime:0,randInt:function(a,b){return Math.floor(Math.random()*(b+1-a))+a},events:{events:{},listen:function(a,b){this.events[a]||(this.events[a]=[]);this.events[a].push(b)},trigger:function(a){var b=[].splice.call(arguments,1),d=this.events[a],c,e;if(d){c=d.length;for(e=0;e<c;e++)d[e].call(h,b)}}},drawRect:function(a,b,d,c,e){this.ctx.save();e&&(this.ctx.fillStyle=e);this.ctx.fillRect(d,c,a,b);this.ctx.restore()},drawImage:function(a,
b,d){this.ctx.drawImage(a,b,d)},drawImageRotated:function(a,b,d,c){b=b*Math.PI/180;this.ctx.save();this.ctx.translate(d+a.width/2,c+a.height/2);this.ctx.rotate(b);this.ctx.drawImage(a,-a.width/2,-a.height/2);this.ctx.restore()},drawText:function(a,b,d,c,e,f){this.ctx.save();c&&(this.ctx.font=c+" sans-serif");e&&(this.ctx.fillStyle=e);f&&(this.ctx.textAlign=f);this.ctx.fillText(a,b,d);this.ctx.restore()},animate:function(a,b,d){var c,e=0;a.animating||(a.animating=!0,a.image=b[0],c=setInterval(function(){b.length===
e?(d(),a.animating=!1,a.image="",clearInterval(c)):(e+=1,a.image=b[e])},1E3/this.fps))},update:function(){},render:function(){},entity:function(a,b){var d,c;c=b&&"object"===typeof b?Object.create(b):{};for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return c},collides:function(a,b){var d,c,e,f,g,h,j,k;d=a.x;c=b.x;e=a.y;f=b.y;g=a.width;h=b.width;j=a.height;k=b.height;return h+c<d||g+d<c?!1:k+f<e||j+e<f?!1:!0},group:function(a,b){this.groups[a]||(this.groups[a]=[]);b&&this.groups[a].push(b);return this.groups[a]},
loadImages:function(){var a,b,d,c,e,f;f=this;this.imagesLoaded=!1;a=[].slice.call(arguments);d=a.length;d||(this.imagesLoaded=!0);c=0;a.forEach(function(a){b=new Image;b.src=a.src;b.onload=function(){c+=1};f.images[a.name]=b});e=setInterval(function(){d===c&&(f.imagesLoaded=!0,clearInterval(e))},100)},onTick:function(a){a=Date.now()-a;this.update(a);this.render(a);this.gameTime+=a},canvas:function(a){if(this===h)return new this.canvas(a);this.canvas=this.canvases[a];return this},run:function(){var a=
this,b=Date.now();setInterval(function(){if(a.imagesLoaded)a.onTick(b);b=Date.now()},1E3/this.fps)}};h.canvas.create=function(a,b,d){var c;c=document.createElement("canvas");c.width=b;c.height=d;b=c.getContext("2d");this.prototype.canvases[a]={canvas:c,ctx:b}};h.canvas.prototype={canvases:{},drawRect:function(a,b,d,c,e){var f=this.canvas.ctx;f.save();e&&(f.fillStyle=e);f.fillRect(d,c,a,b);f.restore();return this},drawImage:function(a,b,d){this.canvas.ctx.drawImage(a,b,d);return this},drawImageRotated:function(a,
b,d,c){var e=this.canvas.ctx;b=b*Math.PI/180;e.save();e.translate(d+a.width/2,c+a.height/2);e.rotate(b);e.drawImage(a,-a.width/2,-a.height/2);e.restore();return this},drawText:function(a,b,d,c,e,f){var g=this.canvas.ctx;g.save();c&&(g.font=c+" sans-serif");e&&(g.fillStyle=e);f&&(g.textAlign=f);g.fillText(a,b,d);g.restore();return this},append:function(a){document[a].appendChild(this.canvas.canvas);return this}};l.headOn=h})(window);